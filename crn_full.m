function dxdt = crn_full(t,x,K)
%reactants
psi_forward = [x(1) * x(4), x(2) * x(4), x(3) * x(4), x(4)^2, x(2) * x(5),...
    x(1) * x(6), x(3) * x(6), x(2) * x(7), x(1) * x(8), x(1) * x(8),...
    x(2) * x(8), x(2) * x(8), x(3) * x(8), x(3) * x(8), x(4) * x(5),...
    x(4) * x(5), x(4) * x(6), x(4) * x(6), x(4) * x(7), x(4) * x(7),...
    x(1) * x(13), x(1) * x(14), x(2) * x(12), x(2) * x(11), x(4) * x(9),...
    x(4) * x(9), x(2) * x(15), x(2) * x(16), x(3) * x(13), x(3) * x(14),...
    x(2) * x(11), x(2) * x(12), x(3) * x(11), x(3) * x(12), x(3) * x(13),...
    x(3) * x(14), x(1) * x(13), x(1) * x(14), x(1) * x(15), x(1) * x(16),...
    x(2) * x(15), x(2) * x(16), x(5) * x(6), x(5) * x(6), x(5) * x(7),...
    x(5) * x(7), x(6) * x(7), x(6) * x(7), x(1) * x(11), x(1) * x(12),...
    x(2) * x(13), x(2) * x(14), x(3) * x(15), x(3) * x(16), x(5)^2, x(6)^2,...
    x(7)^2, x(2) * x(27), x(2) * x(27), x(5) * x(9), x(5) * x(9), ...
    x(1) * x(21), x(1) * x(22), x(1) * x(17), x(1) * x(18), x(1) * x(28),...
    x(1) * x(28), x(6) * x(9), x(6) * x(9), x(2) * x(21), x(2) * x(22),...
    x(2) * x(17), x(2) * x(18), x(3) * x(21), x(3) * x(22), x(5) * x(10),...
    x(5) * x(10), x(2) * x(23), x(2) * x(24), x(1) * x(19), x(1) * x(20),...
    x(2) * x(23), x(2) * x(24), x(2) * x(23), x(2) * x(24), x(7) * x(9),...
    x(7) * x(9), x(1) * x(25), x(1) * x(26), x(3) * x(17), x(3) * x(18),...
    x(3) * x(25), x(3) * x(26), x(7) * x(10),x(7) * x(10), x(2) * x(29),...
    x(2) * x(29), x(3) * x(19), x(3) * x(20),x(3) * x(28), x(3) * x(28),...
    x(6) * x(10), x(6) * x(10), x(2) * x(25),x(2) * x(26), x(2) * x(19),...
    x(2) * x(20), x(9)^2, x(2) * x(30),x(2) * x(31), x(1) * x(32),...
    x(1) * x(33), x(10)^2, x(3) * x(40),x(3) * x(41), x(2) * x(38),...
    x(2) * x(39), x(9) * x(10), x(9) * x(10),x(2) * x(36), x(2) * x(37),...
    x(2) * x(34), x(2) * x(35), x(3) * x(32),x(3) * x(33)];
%products
psi_rev = [x(5), x(6), x(7), x(8), x(9), x(9), x(10), x(10), x(12), x(11),...
    x(14), x(13), x(16), x(15), x(12), x(11), x(14), x(13), x(16), x(15),...
    x(18), x(17), x(17), x(18), x(17), x(18), x(20), x(19), x(20), x(19),...
    x(21), x(22), x(23), x(24), x(25), x(26), x(22), x(21), x(24), x(23),...
    x(26), x(25), x(22), x(21), x(24), x(23), x(25), x(26), x(27), x(27),...
    x(28), x(28), x(29), x(29), x(27), x(28), x(29), x(31), x(30), x(31),...
    x(30), x(31), x(30), x(31), x(30), x(33), x(32), x(33), x(32), x(32),...
    x(33), x(33), x(32), x(34), x(35), x(34), x(35), x(34), x(35), x(34),...
    x(35), x(36), x(37), x(34), x(35), x(35), x(34), x(36), x(37), x(37),...
    x(36), x(38), x(39), x(39), x(38), x(39), x(38), x(39), x(38), x(40),...
    x(41), x(40), x(41), x(40), x(41), x(40), x(41), x(42), x(42), x(42),...
    x(42), x(42), x(43), x(43), x(43), x(43), x(43), x(45), x(44), x(44),...
    x(45), x(44), x(45), x(44), x(45)];
psi = [psi_forward'; psi_rev'];

% reaction rates
a = K(5);
voff = [K(1);K(2);K(4);K(3);K(2)/a;K(1)/a;K(4);K(2);K(1);K(1);K(2);K(2);
K(4);K(4);K(3);K(3);K(3);K(3);K(3);K(3);K(1)/a;K(1)/a;K(2)/a;K(2)/a;K(3);
K(3);K(2);K(2);K(4);K(4);K(2);K(2);K(4);K(4);K(4);K(4);K(1);K(1);K(1);K(1);
K(2);K(2);K(3);K(3);K(3);K(3);K(3);K(3);K(1);K(1);K(2);K(2);K(4);K(4);K(3);
K(3);K(3);K(2)/a;K(2)/a;K(3);K(3);K(1)/a;K(1)/a;K(1);K(1);K(1)/a;K(1)/a;
K(3);K(3);K(2)/a;K(2)/a;K(2);K(2);K(4);K(4);K(3);K(3);K(2);K(2);K(1);K(1);
K(2)/a;K(2)/a;K(2);K(2);K(3);K(3);K(1)/a;K(1)/a;K(4);K(4);K(4);K(4);K(3);
K(3);K(2);K(2);K(4);K(4);K(4);K(4);K(3);K(3);K(2);K(2);K(2);K(2);K(3);
K(2)/a;K(2)/a;K(1)/a;K(1)/a;K(3);K(4);K(4);K(2);K(2);K(3);K(3);K(2);K(2);
K(2)/a;K(2)/a;K(4);K(4)];

von = ones(125,1);
v = [von; voff];

% stoichiometric matrix substrates
s_sub = csvread('s_sub.csv');
s_prod = csvread('s_prod.csv');

% combine matrices for reversibility
Ssub = [s_sub s_prod]; 
Sprod = [s_prod s_sub];
S = Sprod - Ssub;
dxdt = S*(psi.*v);
% dxdt = psi_forward - (voff.*psi_rev);
